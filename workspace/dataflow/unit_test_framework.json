{
  "name": "unit_test_framework",
  "properties": {
    "activities": [
      {
        "name": "ParametrizedUnitTestRunner",
        "type": "SynapseNotebook",
        "dependsOn": [],
        "policy": {
          "timeout": "7.00:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureOutput": false,
          "secureInput": false
        },
        "userProperties": [],
        "typeProperties": {
          "notebook": {
            "referenceName": "parametrized_unit_test_runner",
            "type": "NotebookReference"
          },
          "parameters": {
            "test_config": {
              "value": "@pipeline().parameters.test_config",
              "type": "Expression"
            },
            "entity_name": {
              "value": "@pipeline().parameters.entity_name",
              "type": "Expression"
            }
          },
          "snapshot": true,
          "sparkPool": {
            "referenceName": "pinssynspodw34",
            "type": "BigDataPoolReference"
          },
          "executorSize": "Medium",
          "conf": {
            "spark.dynamicAllocation.enabled": false,
            "spark.dynamicAllocation.minExecutors": 2,
            "spark.dynamicAllocation.maxExecutors": 2
          },
          "driverSize": "Medium",
          "numExecutors": 2
        }
      }
    ],
    "parameters": {
      "test_config": {
        "type": "object",
        "defaultValue": {
          "entity_name": "appeal-document",
          "databases": {
            "standardised": "odw_standardised_db",
            "harmonised": "odw_harmonised_db",
            "curated": "odw_curated_db"
          },
          "tables": {
            "std_table": "sb_appeal_document",
            "hrm_table": "sb_appeal_document",
            "hrm_final": "appeal_document",
            "curated_table": "appeal_document"
          },
          "test_categories": [
            "schema_validation",
            "row_count_validation",
            "data_integrity",
            "no_record_dropping"
          ],
          "primary_key": "documentId"
        }
      },
      "entity_name": {
        "type": "string",
        "defaultValue": "appeal-document"
      }
    },
    "annotations": []
  },
  "type": "Microsoft.Synapse/workspaces/pipelines"
}
