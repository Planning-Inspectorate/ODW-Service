{
	"name": "sql-dsql-employee-create-table",
	"properties": {
		"folder": {
			"name": "dedicated-sql-pool"
		},
		"content": {
			"query": "TRUNCATE TABLE [dbo].[employee_syn]\n\nDROP TABLE [dbo].[employee_syn]\n\n-- A: Create the target table\n-- employee_syn\nCREATE TABLE [dbo].[employee_syn]\n(\n    [Profession] [varchar](255) NULL,\n    [Pers_No] [varchar](255) NOT NULL,\n    [Employee_Number] [varchar](255) NULL,\n    [First_Name] [varchar](255) NULL,\n    [Last_Name] [varchar](255) NULL,\n    [PA] [varchar](255) NULL,\n    [Personnel_Area] [varchar](255) NULL,\n    [Personnel_SubArea] [varchar](255) NULL,\n    [PSubArea] [varchar](255) NULL,\n    [Org_unit] [varchar](255) NULL,\n    [Organizational_Unit] [varchar](255) NULL,\n    [Organizational_Key] [varchar](255) NULL,\n    [Organizational_Key1] [varchar](255) NULL,\n    [WorkC] [varchar](255) NULL,\n    [Work_Contract] [varchar](255) NULL,\n    [CT] [varchar](255) NULL,\n    [Contract_Type] [varchar](255) NULL,\n    [PS_Group] [varchar](255) NULL,\n    [Pay_Band_Description] [varchar](255) NULL,\n    [FTE] [varchar](255) NULL,\n    [Wk_Hrs] [varchar](255) NULL,\n    [Work_Schedule] [varchar](255) NULL,\n    [Is_Part_Time] [varchar](255) NULL,\n    [S] [varchar](255) NULL,\n    [Employment_Status] [varchar](255) NULL,\n    [Gender_Key] [varchar](255) NULL,\n    [TRA_Start_Date] [varchar](255) NULL,\n    [TRA_End_Date] [varchar](255) NULL,\n    [TRA_Status] [varchar](255) NULL,\n    [TRA_Grade] [varchar](255) NULL,\n    [Prev_PersNo] [varchar](255) NULL,\n    [ActR] [varchar](255) NULL,\n    [Reason_For_Action] [varchar](255) NULL,\n    [Position] [varchar](255) NULL,\n    [Position1] [varchar](255) NULL,\n    [Cost_Ctr] [varchar](255) NULL,\n    [Cost_Centre] [varchar](255) NULL,\n    [Civil_Service_Start] [varchar](255) NULL,\n    [Date_To_Current_Job] [varchar](255) NULL,\n    [Seniority_Date] [varchar](255) NULL,\n    [Date_To_Subst_Grade] [varchar](255) NULL,\n    [Pers_No_1] [varchar](255) NULL,\n    [Name_of_Manager] [varchar](255) NULL,\n    [Manager_Position] [varchar](255) NULL,\n    [Manager_Position_Text] [varchar](255) NULL,\n    [Counter_Sign_Manager] [varchar](255) NULL,\n    [Loc] [varchar](255) NULL,\n    [Location] [varchar](255) NULL,\n    [Org_Start_Date] [varchar](255) NULL,\n    [Fix_Term_End_Date] [varchar](255) NULL,\n    [Loan_Start_Date] [varchar](255) NULL,\n    [Loan_End_Date] [varchar](255) NULL,\n    [EEGrp] [varchar](255) NULL,\n    [Employee_Group] [varchar](255) NULL,\n    [Annual_salary] [varchar](255) NULL,\n    [Curr] [varchar](255) NULL,\n    [NI_number] [varchar](255) NULL,\n    [Birth_date] [varchar](255) NULL,\n    [Age_of_employee] [varchar](255) NULL,\n    [EO] [varchar](255) NULL,\n    [Rel] [varchar](255) NULL,\n    [Religious_Denomination_Key] [varchar](255) NULL,\n    [SxO] [varchar](255) NULL,\n    [Ethnic_origin] [varchar](255) NULL,\n    [Disability_Code] [varchar](255) NULL,\n    [Disability_Text] [varchar](255) NULL,\n    [Disability_Code_Description] [varchar](255) NULL,\n    [NID] [varchar](255) NULL,\n    [Wage_Type] [varchar](255) NULL,\n    [Employee_Subgroup] [varchar](255) NULL,\n    [LOA_Abs_Type] [varchar](255) NULL,\n    [LOA_Absence_Type_Text] [varchar](255) NULL,\n    [Scheme_reference] [varchar](255) NULL,\n    [Pension_Scheme_Name] [varchar](255) NULL,\n    [PArea] [varchar](255) NULL,\n    [Payroll_Area] [varchar](255) NULL,\n    [Assignment_Number] [varchar](255) NULL,\n    [Company_Code] [varchar](255) NULL,\n    [CoCd] [varchar](255) NULL,\n    [Email_Address] [varchar](255) NULL,\n    [Address_Line_1] [varchar](255) NULL,\n    [Address_Line_2] [varchar](255) NULL,\n    [Town] [varchar](255) NULL,\n    [County] [varchar](255) NULL,\n    [Postcode] [varchar](255) NULL,\n    [Phone_Number] [varchar](255) NULL,\n    [Annual_Leave_Start] [varchar](255) NULL,\n    [Active_Status] [varchar](255) NULL,\n    [Is_Charting_Officer] [varchar](255) NULL,\n    [Charting_Officer_ID] [varchar](255) NULL,\n    [Grade] [varchar](255) NULL,\n    [Is_Sub_Group_Leader] [varchar](255) NULL,\n    [Is_APO] [varchar](255) NULL,\n    [Is_APOM] [varchar](255) NULL,\n    [FTE_Primary] [varchar](255) NULL,\n    [FTE_Secondary] [varchar](255) NULL,\n    [Location_Primary] [varchar](255) NULL,\n    [Location_Secondary] [varchar](255) NULL,\n    [Leaving_Date] [varchar](255) NULL,\n    [Attribute10] [varchar](255) NULL\n)\nWITH\n(\n    DISTRIBUTION = HASH([Pers_No]),\n    CLUSTERED COLUMNSTORE INDEX\n    --HEAP\n);\n\n\n-- B: Create and execute the COPY statement\n\nCOPY INTO [dbo].[employee_syn] \n--The column list allows you map, omit, or reorder input file columns to target table columns. \n--You can also specify the default value when there is a NULL value in the file.\n--When the column list is not specified, columns will be mapped based on source and target ordinality\n--The storage account location where you data is staged\nFROM 'https://pinsodwdatadevstorage.blob.core.windows.net/odw-curated/employee-syn/employee-syn/*.parquet'\nWITH \n(\n   --CREDENTIAL: Specifies the authentication method and credential access your storage account\n    CREDENTIAL=(IDENTITY= 'Storage Account Key', SECRET=''),\n   --FILE_TYPE: Specifies the file type in your storage account location\n   FILE_TYPE = 'PARQUET',\n    COMPRESSION = 'Snappy'\n);\n\n\nALTER INDEX ALL ON [dbo].[employee_syn] REBUILD;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "odwdevdsqlpool",
				"poolName": "odwdevdsqlpool"
			},
			"resultLimit": -1
		},
		"type": "SqlQuery"
	}
}