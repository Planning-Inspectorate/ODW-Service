{
    "cell_type": "code",
    "metadata": {
        "microsoft": {
            "language": "sparksql"
        },
        "jupyter": {
            "source_hidden": false,
            "outputs_hidden": false
        },
        "nteract": {
            "transient": {
                "deleting": false
            }
        },
        "collapsed": false
    },
    "source": [
        "%%sql\r\n",
        "-- Insert new SXOID\r\n",
        "\r\n",
        "INSERT OVERWRITE odw_harmonised_db.service_user_dim\r\n",
        "\r\n",
        "SELECT \r\n",
        "    ROW_NUMBER() OVER (ORDER BY ServiceDataID NULLS LAST) AS ServiceDataID,\r\n",
        "    TicketID,\r\n",
        "    CaseReference,\r\n",
        "    Salutation,\r\n",
        "    FullName,\r\n",
        "    AddressLine1,\r\n",
        "    AddressLine2,\r\n",
        "    AddressTown,\r\n",
        "    AddressCounty,\r\n",
        "    Postcode,\r\n",
        "    AddressCountry,\r\n",
        "    Organisation,\r\n",
        "    OrganisationType,\r\n",
        "    Role,\r\n",
        "    TelephoneNumber,\r\n",
        "    OtherPhoneNumber,\r\n",
        "    FaxNumber,\r\n",
        "    EmailAddress,\r\n",
        "    SourceSystemID,\r\n",
        "    IngestionDate,\r\n",
        "    ValidTo,\r\n",
        "    RowID,\r\n",
        "    IsActive\r\n",
        "FROM odw_harmonised_db.service_user_dim;\r\n",
        ""
    ],
    "outputs": [],
    "execution_count": 15
}